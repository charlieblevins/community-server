{"version":3,"file":"LinkRelMetadataWriter.js","sourceRoot":"","sources":["../../../../src/http/output/metadata/LinkRelMetadataWriter.ts"],"names":[],"mappings":";;;AAAA,sDAAwD;AAExD,yDAAqD;AAErD,qDAAkD;AAElD;;;GAGG;AACH,MAAa,qBAAsB,SAAQ,+BAAc;IAIvD,YAAmB,UAAkC;QACnD,KAAK,EAAE,CAAC;QAHS,WAAM,GAAG,sBAAY,CAAC,IAAI,CAAC,CAAC;QAI7C,IAAI,CAAC,UAAU,GAAG,UAAU,CAAC;IAC/B,CAAC;IAEM,KAAK,CAAC,MAAM,CAAC,KAAmE;QACrF,MAAM,IAAI,GAAG,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;QAC1C,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,6BAA6B,IAAI,CAAC,MAAM,EAAE,CAAC,CAAC;QAC9D,KAAK,MAAM,GAAG,IAAI,IAAI,EAAE;YACtB,MAAM,MAAM,GAAG,KAAK,CAAC,QAAQ,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC,IAAI,EAAU,EAAE,CAAC,IAAI,IAAI,CAAC,KAAK,WAAW,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;YAClH,IAAI,MAAM,CAAC,MAAM,GAAG,CAAC,EAAE;gBACrB,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,sBAAsB,MAAM,EAAE,CAAC,CAAC;gBAClD,sBAAS,CAAC,KAAK,CAAC,QAAQ,EAAE,MAAM,EAAE,MAAM,CAAC,CAAC;aAC3C;SACF;IACH,CAAC;CACF;AApBD,sDAoBC","sourcesContent":["import { getLoggerFor } from '../../../logging/LogUtil';\nimport type { HttpResponse } from '../../../server/HttpResponse';\nimport { addHeader } from '../../../util/HeaderUtil';\nimport type { RepresentationMetadata } from '../../representation/RepresentationMetadata';\nimport { MetadataWriter } from './MetadataWriter';\n\n/**\n * A {@link MetadataWriter} that takes a linking metadata predicates to Link header \"rel\" values.\n * The values of the objects will be put in a Link header with the corresponding \"rel\" value.\n */\nexport class LinkRelMetadataWriter extends MetadataWriter {\n  private readonly linkRelMap: Record<string, string>;\n  protected readonly logger = getLoggerFor(this);\n\n  public constructor(linkRelMap: Record<string, string>) {\n    super();\n    this.linkRelMap = linkRelMap;\n  }\n\n  public async handle(input: { response: HttpResponse; metadata: RepresentationMetadata }): Promise<void> {\n    const keys = Object.keys(this.linkRelMap);\n    this.logger.debug(`Available link relations: ${keys.length}`);\n    for (const key of keys) {\n      const values = input.metadata.getAll(key).map((term): string => `<${term.value}>; rel=\"${this.linkRelMap[key]}\"`);\n      if (values.length > 0) {\n        this.logger.debug(`Adding Link header ${values}`);\n        addHeader(input.response, 'Link', values);\n      }\n    }\n  }\n}\n"]}