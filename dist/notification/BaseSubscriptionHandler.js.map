{"version":3,"file":"BaseSubscriptionHandler.js","sourceRoot":"","sources":["../../src/notification/BaseSubscriptionHandler.ts"],"names":[],"mappings":";;;AAGA,4DAA4D;AAI5D,MAAsB,uBAAuB;IAQpC,KAAK,CAAC,kBAAkB,CAAC,SAA6B,EAAE,YAA0B;QACvF,SAAS,CAAC,OAAO,CAAC,CAAC,QAAQ,EAAQ,EAAE,CAAC,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,gBAAgB,CAAC,CAAC,QAAQ,CAAC,QAAQ,EAAE,YAAY,CAAC,CAAC,CAAC;IACpH,CAAC;IAEO,SAAS,CACf,gBAAkC;QAElC,wCAAwC;QACxC,QAAQ,gBAAgB,EAAE;YACxB,KAAK,gCAAgB,CAAC,OAAO,CAAC,CAAC,OAAO,IAAI,CAAC,iBAAiB,CAAC;YAC7D,KAAK,gCAAgB,CAAC,OAAO,CAAC,CAAC,OAAO,IAAI,CAAC,iBAAiB,CAAC;YAC7D,KAAK,gCAAgB,CAAC,OAAO,CAAC,CAAC,OAAO,IAAI,CAAC,iBAAiB,CAAC;SAC9D;IACH,CAAC;CACF;AAtBD,0DAsBC","sourcesContent":["import type { Readable } from 'stream';\nimport type { ModifiedResource } from '..';\nimport type { ResourceIdentifier } from '../http/representation/ResourceIdentifier';\nimport { ModificationType } from '../storage/ResourceStore';\nimport type { Guarded } from '../util/GuardedStream';\nimport type { Subscription, SubscriptionHandler } from './SubscriptionHandler';\n\nexport abstract class BaseSubscriptionHandler\nimplements SubscriptionHandler {\n  public abstract getResponseData(subscription: Subscription): Guarded<Readable> | undefined;\n  public abstract getType(): string;\n  public abstract subscribe(request: any): Subscription;\n  public abstract onResourceCreated(resource: ResourceIdentifier, subscription: Subscription): void;\n  public abstract onResourceChanged(resource: ResourceIdentifier, subscription: Subscription): void;\n  public abstract onResourceDeleted(resource: ResourceIdentifier, subscription: Subscription): void;\n  public async onResourcesChanged(resources: ModifiedResource[], subscription: Subscription): Promise<void> {\n    resources.forEach((modified): void => this.onHandler(modified.modificationType)(modified.resource, subscription));\n  }\n\n  private onHandler(\n    modificationType: ModificationType,\n  ): ((resource: ResourceIdentifier, subscription: Subscription) => void) {\n    // eslint-disable-next-line default-case\n    switch (modificationType) {\n      case ModificationType.created: return this.onResourceCreated;\n      case ModificationType.changed: return this.onResourceChanged;\n      case ModificationType.deleted: return this.onResourceDeleted;\n    }\n  }\n}\n"]}